<div class="p-6 bg-gray-900 min-h-screen text-white">

  <h1 class="text-3xl font-bold mb-6">Pokémon Catalogue</h1>

  <!-- Search Bar -->
  <div class="mb-6">
    <input 
      [(ngModel)]="searchTerm"
      (input)="onSearchChange()"
      placeholder="Search Pokémon..."
      class="w-full px-4 py-2 bg-gray-800 text-white rounded-lg border border-gray-600 focus:border-blue-500 focus:outline-none">
  </div>

  <!-- Deferrable Pokemon Grid -->
  @defer (when !loading()) {
    <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
      @for (p of filteredPokemon(); track p.name) {
        <div class="bg-gray-800 rounded-xl p-4 flex flex-col items-center relative">
          @if (isCollected(p.name)) {
            <span class="absolute top-2 right-2 w-6 h-6 rounded-full flex items-center justify-center"> 
              <div class="p-1 bg-amber-500 rounded-[50%]"></div>
            </span>
          }

          <img [src]="p.image" class="w-20 h-20 mb-3" />
          <h3 class="capitalize text-lg font-semibold mb-2">{{ p.name }}</h3>
          
          <button
            (click)="catchPokemon(p)"
            [disabled]="isCollected(p.name)"
            class="px-3 py-1 rounded bg-blue-500 hover:bg-blue-600 disabled:bg-gray-600 disabled:cursor-not-allowed">
            {{ isCollected(p.name) ? 'Caught' : 'Catch' }}
          </button>
        </div>
      }
    </div>
  } @placeholder {
    <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
      @for (i of [1,2,3,4,5,6,7,8]; track i) {
        <div class="bg-gray-800 rounded-xl p-4 flex flex-col items-center animate-pulse">
          <div class="w-20 h-20 bg-gray-600 rounded mb-3"></div>
          <div class="w-16 h-4 bg-gray-600 rounded mb-2"></div>
          <div class="w-12 h-6 bg-gray-600 rounded"></div>
        </div>
      }
    </div>
  } @error {
    <div class="text-center py-8">
      <p class="text-red-400 text-xl">Failed to load Pokémon</p>
      <button (click)="loadPokemon()" class="mt-4 px-4 py-2 bg-blue-500 rounded">Retry</button>
    </div>
  } 

  <!-- Next Button -->
  <div class="fixed bottom-6 right-6">
    <button 
      (click)="goToTrainer()"
      class="px-6 py-3 bg-red-500 hover:bg-red-600 rounded-lg text-white font-bold">
      Next →
    </button>
  </div>

</div>
